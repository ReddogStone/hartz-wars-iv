<html>
<head>
	<title>My first Three.js app</title>
	
	<script src="utils.js" type="text/javascript"></script>
	<script src="fileutils.js" type="text/javascript"></script>
	<script src="webgl_utils.js" type="text/javascript"></script>
	<script src="engine3d.js" type="text/javascript"></script>
	<script src="mesh.js" type="text/javascript"></script>
	<script src="sprite_renderable.js" type="text/javascript"></script>

	<script src="Matrix4.js" type="text/javascript"></script>
	<script src="Vector3.js" type="text/javascript"></script>
	<script src="Vector4.js" type="text/javascript"></script>
</head>
<body>
<canvas id="canvas" width="1024" height="768"></canvas>

<script>
	window.requestAnimFrame = (function () {
		return window.requestAnimationFrame ||
			window.webkitRequestAnimationFrame ||
			window.mozRequestAnimationFrame ||
			window.oRequestAnimationFrame ||
			window.msRequestAnimationFrame ||
			function(callback){
				window.setTimeout(callback, 1000 / 60);
			};
	}) ();
	
	function render() {
		Engine3D.renderFrame(scene);
		
		scene.nodes[0].position.globalTransform.translate(new Vecmath.Vector3(0.001, 0, 0));

		requestAnimFrame( function() { render(); } );
	}

	var canvas = document.getElementById('canvas');
	Engine3D.init(canvas);
	
	var sprite1 = {
		renderable: new SpriteRenderable(Engine3D),
		position: {
			globalTransform: new Vecmath.Matrix4().translate(new Vecmath.Vector3(0.6, 0, 0))
		}
	};
	var sprite2 = {
		renderable: new SpriteRenderable(Engine3D),
		position: {
			globalTransform: new Vecmath.Matrix4().translate(new Vecmath.Vector3(-0.6, 0, 0))
		}
	};
	var scene = {
		viewport: { x: 0, y: 0, sx: canvas.width, sy: canvas.height },
		view: new Vecmath.Matrix4().lookAt(new Vecmath.Vector3(0, 0, 1),
			new Vecmath.Vector3(0, 0, 0),
			new Vecmath.Vector3(0, 1, 0)),
		projection: new Vecmath.Matrix4().perspective(0.5 * Math.PI, canvas.width / canvas.height, 0.01, 1000),
		nodes: [sprite1, sprite2]
	};
	
	requestAnimFrame(function() { render(); });
	alert('OK')
</script>
</body>
</html>